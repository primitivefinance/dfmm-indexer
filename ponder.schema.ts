import { createSchema } from "@ponder/core";

export default createSchema((p) => ({
  Pool: p.createTable({
    id: p.bigint(),
    tokenIndexId: p.hex().references("TokenIndex.id"),
    tokenIndex: p.one("tokenIndexId"),
    strategyId: p.hex().references("Strategy.id"),
    strategy: p.one("strategyId"),
    accountId: p.hex().references("Account.id"),
    account: p.one("accountId"),
    timestamp: p.bigint(),
    reservesWad: p.bigint().list(),
    reserves: p.float().list(),
    weightsWad: p.bigint().list(),
    weights: p.float().list(),
    liquidityWad: p.bigint(),
    liquidity: p.float(),
    lpToken: p.hex(),
    name: p.string(),
    positions: p.many("Position.poolId"),
  }),
  Token: p.createTable({
    id: p.hex(),
    name: p.string(),
    symbol: p.string(),
    decimals: p.int(),
  }),
  TokenIndex: p.createTable({
    id: p.hex(),
    tokens: p.hex().list(),
  }),
  Account: p.createTable({
    id: p.hex(),
    positions: p.many("Position.accountId"),
    swapPoints: p.bigint(),
    wrPoints: p.bigint(),
    slPoints: p.bigint(),
    pointsTotal: p.bigint(),
  }),
  Period: p.createTable({
    id: p.bigint(),
    start: p.int(),
    end: p.int(),
    current: p.boolean(),
  }),
  Position: p.createTable({
    id: p.hex(),
    liquidity: p.float(),
    liquidityWad: p.bigint(),
    accountId: p.hex().references("Account.id"),
    account: p.one("accountId"),
    poolId: p.bigint().references("Pool.id"),
    pool: p.one("poolId"),
  }),
  G3MNParameters: p.createTable({
    id: p.bigint(),
    swapFee: p.float(),
    swapFeeWad: p.bigint(),
    weightX: p.float(),
    weightXWad: p.bigint(),
    weights: p.float().list(),
    weightsWad: p.bigint().list(),
    controller: p.hex(),
  }),
  CSParameters: p.createTable({
    id: p.bigint(),
    price: p.bigint(),
    swapFee: p.float(),
    swapFeeWad: p.bigint(),
    controller: p.hex(),
  }),
  Strategy: p.createTable({
    id: p.hex(),
    name: p.string(),
    pools: p.many("Pool.strategyId"),
  }),
}));